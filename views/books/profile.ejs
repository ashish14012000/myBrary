<!-- All the information about a single book, accessible to everyone -->
<%- include('../partials/header')%>
<div class="container">
    <div class="ml-5 mt-3">
        <h2>Name: <%= book.name %> </h2>
        <h4>ISBN: <%= book.isbn %> </h4>
        <h4>Authors: </h4>
        <ul>
            <% authorIDs.forEach((authorObj, i) => { %>
                <li><a href="/authors/<%= authorObj._id %>"><%= authorNames[i]%> </a></li>
            <% }); %> 
        </ul>
        <h4>Genres: </h4>
        <ul>
            <% genreIDs.forEach((genreObj, i) => { %>
                <li><a href="/genres/<%= genreObj._id %>"><%= genreNames[i]%> </a></li>
            <% }); %> 
        </ul>
        <h4>Quantity Available: <%= book.quantity %></h4>
        <h4>Total Issues: <%= book.totalIssues %></h4>
    </div>
    <% if(currentReader && currentReader.isAdmin){ %> 
        <form action="/books/<%= book._id%>?_method=DELETE" method="POST" class="mt-3 mb-3">
            <div class="form-group"><button class="btn btn-danger">Delete</button></div>
        </form>
        <div class="form-group">
            <a href="/books/<%= book._id %>/update-qty" class="btn btn-warning">Update Quantity</a>
        </div>
    <% } %> 
    <% if(currentReader){ %> 
        <div class="text-right">
            <a class="btn btn-success btn-lg" href="/books/<%= book._id%>/comments/new">Add New Comments</a>
        </div>
        <hr>
        <% comments.forEach(function(comment){ %>
            <div class="row mb-4">
                <div class="col-md-12">
                    <strong><%= comment.author.authorName %></strong>
                    <p>
                        <%= comment.text%>
                    </p>
                    <% if(comment.author.id.equals(currentReader._id)){ %>
                        <div class="row">
                            <div class="col-md-1">
                                <a href="/books/<%= book._id%>/comments/<%= comment._id%>/edit" class="btn btn-warning btn-sm">Edit</a>
                            </div>
                            <div class="col-md-3">
                                <form action="/books/<%= book._id%>/comments/<%= comment._id%>?_method=DELETE" method="POST" class="delete-form">
                                    <button class="btn btn-danger btn-sm">Delete</button>
                                </form>
                            </div>
                        </div>
                    <% } %>
                </div>
            </div>
            <hr>
        <% }) %>                
    <% } %> 
</div>

<%- include('../partials/footer')%>